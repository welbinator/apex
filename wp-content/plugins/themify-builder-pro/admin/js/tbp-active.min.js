'use strict';(function(f,d){function n(d){return!("advanced-posts"===d&&"archive"===tbp_local.template||"advanced-products"===d&&"product_archive"===tbp_local.template)}Themify.LoadCss(tbp_local.cssUrl,tbp_local.v);window.top.Themify.LoadCss(tbp_local.cssUrl,tbp_local.v);tbp_local.cssUrl=null;"undefined"!==typeof tbp_local&&tbp_local.template&&(document.body.classList.add("tbp_template_type_"+tbp_local.template),window.top.document.body.classList.add("tbp_template_type_"+tbp_local.template));let h=
null;const q=function(b,a){f(".builder-posts-wrap > .themify_builder_slider",b).each(function(){this.swiper.destroy();f(this).find("article.post").first().prependTo(f(this).closest(".builder-posts-wrap")).siblings().remove()});var e=b.getElementsByClassName("tbp_advanchd_archive_wrap")[0],c=-1!==a.get("mod_name").indexOf("product")?"_product":"";const l="tbp_edit"+c+"_archive",p="tbp_edit"+c+"_single";c=["order","orderby","offset","meta_key"];const k=a.get("element_id"),m=f.extend(!0,{},a.get("mod_settings"));
e.classList.add("themify_builder_content");e.classList.add("themify_builder_content-"+k);e.classList.add("themify_builder");e.setAttribute("id","themify_builder_content-"+k);e.setAttribute("data-postid",k);e=m.builder_content;let g=f("."+l);"string"===typeof e&&(e=JSON.parse(e));h={aap:!0};!0===n(a.attributes.mod_name)&&(c.push("terms"),c.push("term_type"),c.push("tax"),c.push("post_type"));for(let a=c.length-1;-1<a;--a)void 0!==m[c[a]]&&""!==m[c[a]]&&(h[c[a]]=m[c[a]]);d.Forms.LayoutPart.cache[k]=
e;d.activeModel=d.ActionBar.hoverCid=e=null;document.body.className+=" tbp_app_is_edit tbp_module_"+a.get("mod_name");window.top.document.body.className+=" tbp_app_is_edit tbp_module_"+a.get("mod_name");g=g.add(f("."+l,window.top.document));for(c=g.length-1;-1<c;--c)g[c].classList.remove(l),g[c].classList.add(p);f(b).one("tb_layout_part_before_init",function(){const c=f(this).find(".tb_toolbar_save"),b=f(this).find(".tb_toolbar_close_btn");c.on("click",function(c){c.preventDefault();c.stopImmediatePropagation();
if(null!==d.activeModel||0<ThemifyBuilderCommon.Lightbox.$lightbox.length&&ThemifyBuilderCommon.Lightbox.$lightbox[0].classList.contains("tb_custom_css_lightbox"))c=ThemifyBuilderCommon.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0],void 0!==c&&c.click();c=a.get("mod_settings");c.builder_content=d.Utils.clear(d.Mixins.Builder.toJSON(d.Instances.Builder[d.builderIndex].el));a.set(c,{silent:!0});ThemifyBuilderCommon.showLoader("show");setTimeout(function(){ThemifyBuilderCommon.showLoader("hide");
d.Forms.LayoutPart.options=null;d.Forms.LayoutPart.isSaved=!0},100)});b.on("click",function(b){b.preventDefault();b.stopImmediatePropagation();const e=!0===d.Forms.LayoutPart.isSaved;h=null;d.Forms.LayoutPart.close(b);if(!0===e||0===d.builderIndex){f(this).off("click");c.off("click");delete d.Forms.LayoutPart.cache[k];d.activeModel=d.ActionBar.hoverCid=null;document.body.classList.remove("tbp_app_is_edit","tbp_module_"+a.get("mod_name"));window.top.document.body.classList.remove("tbp_app_is_edit",
"tbp_module_"+a.get("mod_name"));for(b=g.length-1;-1<b;--b)g[b].classList.add(l),g[b].classList.remove(p);!0===e&&(ThemifyBuilderCommon.showLoader("show"),a.trigger("custom:preview:refresh",a.get("mod_settings")),setTimeout(function(){d.ActionBar.hoverCid=null;ThemifyBuilderCommon.showLoader("hide")},220))}});f(".tb_overlay").first().one("dblclick",function(a){a.preventDefault();a.stopImmediatePropagation();d.Forms.LayoutPart.options=null;d.Forms.LayoutPart.isSaved=!0;c.triggerHandler("click");b.triggerHandler("click")})})};
d.Constructor.advanced_posts_query={render:function(b,a){return!0===n("advanced-posts")?a.query_posts.render({type:"query_posts",id:"post_type",tax_id:"tax",term_id:"terms",slug_id:"slug",wrap_class:"tbp_app_post_query"},a):document.createDocumentFragment()}};d.Constructor.advanced_products_query={render:function(b,a){return!0===n("advanced-products")?(b=document.createDocumentFragment(),b.appendChild(a.query_posts.render({type:"query_posts",term_id:"terms",taxonomy:"product_cat"},a)),b):document.createDocumentFragment()}};
d.Constructor.tbp_advanched_layout={render:function(b,a){const e=document.createDocumentFragment();if("visual"===d.mode){const a=document.createElement("a"),b=function(a){a.stopPropagation();a.preventDefault();this.removeEventListener("click",b,{once:!0});const c=d.activeModel.cid;ThemifyConstructor.saveComponent();this.className+=" tb_edit";d.Models.Registry.lookup(c).trigger("edit",a,this)};a.className="tbp_advanched_archive_edit";a.href="#";a.textContent=tbp_local.edit;a.addEventListener("click",
b,{once:!0});e.appendChild(a)}a.values[b.id]&&(a.values[b.id]=JSON.stringify(a.values[b.id]));e.appendChild(a.hidden.render(b,a));return e}};d.Constructor.fallback={render:function(b,a){return a.create([{id:"fallback_s",type:"toggle_switch",label:"fall_b",options:{on:{name:"yes",value:"en"},off:{name:"no",value:"dis"}},binding:{checked:{show:["fallback_i"]},not_checked:{hide:["fallback_i"]}}},{id:"fallback_i",type:"image",wrap_class:"pushed","class":"xlarge"}])}};d.Constructor.tbp_custom_css={render:function(b,
a){return a.create([{id:"css",type:"custom_css"},{type:"custom_css_id"}])}};"visual"===d.mode&&(void 0!==tbp_local.id&&f.ajaxPrefilter(function(b,a,d){if(a.data&&("tb_render_element"===a.data.action||"tb_load_module_partial"===a.data.action)){b.data+="&pageId="+tbp_local.id;a=null;if(null!==h)for(let c in h)"tax"===c?a=h[c]:b.data+="&"+c+"="+h[c];null===a&&(a=tbp_local.type);b.data+="&type="+a}}),Themify.body.on("tb_edit_advanced-posts tb_edit_advanced-products",function(b,a,e,c){if(!d.Forms.LayoutPart.id&&
a&&("dblclick"===a.type||a.target.classList.contains("tb_edit")))return null!==d.activeModel&&f(".builder_save_button",ThemifyBuilderCommon.Lightbox.$lightbox[0]).click(),q(e,c),!0}));f(document).on("tb_editing_module",function(b){const a=themifyBuilder.DynamicQuery.input;f(ThemifyBuilderCommon.Lightbox.$lightbox[0]).find('.tb_field[data-type="query_posts"]').each(function(){const b=f(this);if(!b.prev(".tb_field.tbpdq").length){var c=b.find(".tb_search_input.tb_lb_option:first").prop("id");a.binding=
{off:{show:[c]},on:{hide:[c]}};"archive"!==tbp_local.template&&(a.wrap_class="tf_hide");f(ThemifyConstructor.create([a])).insertBefore(b)}})})})(jQuery,tb_app);
