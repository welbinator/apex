'use strict';(function(e,c,l){let d="";const k=[/\x3c!--themify_builder_static--\x3e([\s\S]*?)\x3c!--\/themify_builder_static--\x3e/gi,/&lt;!--themify_builder_static--&gt;([\s\S]*?)&lt;!--\/themify_builder_static--&gt;/gi,/&amp;lt;!--themify_builder_static--&amp;gt;([\s\S]*?)&amp;lt;!--\/themify_builder_static--&amp;gt;/gi],f=themifyBuilder.short_badge?"excerpt":"content";c.mce.views.register("tb_static_badge",{template:c.media.template("tb-static-badge"),bindNode(a,b){e(b).on("click",".tb_mce_view_frontend_btn",
this.goToFront).on("click",".tb_mce_view_backend_btn",this.goToBack)},getContent(){return this.template({})},match(a){if(a=c.mce.views._tb_static_content.isMatch(a))return{index:a.index,content:a[0],options:{}}},View:{className:"tb_static_badge",template:c.media.template("tb-static-badge"),getHtml:function(){return this.template({})}},edit(a){this.goToFront()},goToFront(){e("#tb_switch_frontend").trigger("click")},goToBack(){tb_app._backendBuilderFocus()},contentPlaceholder(a){d=d||a;return"\x3c!--themify_builder_static--\x3e\x3c!--/themify_builder_static--\x3e"+
(59<a.length?" ".repeat(a.length-59):"")}});c.mce.views._tb_static_content={setContent(a,b){b&&(b=b.trim());tinyMCE&&tinyMCE.activeEditor&&tinyMCE.activeEditor.id===f?tinyMCE.activeEditor.hidden?b!==e("#"+f).val().trim()&&e("#"+f).val(b):b!==a.getContent().trim()&&a.setContent(b):b!==a.val().trim()&&a.val(b)},isMatch(a){return k[0].exec(a)||k[1].exec(a)||k[2].exec(a)}};e(document).on("tinymce-editor-init",function(a,b){if(b.wp&&b.wp._createToolbar){const a=b.wp._createToolbar(["wp_view_edit"]);if(a)b.on("wptoolbar",
function(c){b.dom.hasClass(c.element,"wpview")&&"tb_static_badge"===b.dom.getAttrib(c.element,"data-wpview-type")&&(c.toolbar=a)})}if(b.id!==f){a=b.getContent();let g=c.mce.views._tb_static_content.isMatch(a);l.isNull(g)||b.setContent(a.replace(g[0],""))}else b.setContent(c.mce.views.setMarkers(b.getContent()));b.on("beforesetcontent",function(a){a.content=c.mce.views.setMarkers(a.content)})});e("body").on("themify_builder_save_data",function(a,b){if(themifyBuilder.is_gutenberg_editor||!b.data||!b.data.static_content)return!0;
let g,d;if(tinyMCE&&tinyMCE.activeEditor&&tinyMCE.activeEditor.id===f)a=tinyMCE.activeEditor,g=!1===tinyMCE.activeEditor.hidden?tinyMCE.activeEditor.getContent():tinymce.DOM.get(f).value;else{a=e("#"+f);if(!a.length)return;g=a.val()}d=c.mce.views._tb_static_content.isMatch(g);l.isNull(d)?c.mce.views._tb_static_content.setContent(a,g+b.data.static_content):c.mce.views._tb_static_content.setContent(a,g.replace(d[0],b.data.static_content))});const h={timeout:null,init(){e(window).on("YoastSEO:ready",
function(){h.load()})},load(){themifyBuilder.is_gutenberg_editor&&(d=c.data.select("core/editor").getCurrentPost().builder_content);YoastSEO.app.registerPlugin("TBuilderReader",{status:"loading"});YoastSEO.app.pluginReady("TBuilderReader");YoastSEO.app.registerModification(f,h.readContent,"TBuilderReader",5);h.update()},readContent(a){d&&(a=themifyBuilder.is_gutenberg_editor?a+(" "+d):a.replace("\x3c!--themify_builder_static--\x3e\x3c!--/themify_builder_static--\x3e",d).replace(/(\r\n|\n|\r)/gm,""));
return a},update(){this.timeout&&clearTimeout(this.timeout);this.timeout=setTimeout(function(){YoastSEO.app.refresh()},250)}};h.init()})(jQuery,wp,_);
